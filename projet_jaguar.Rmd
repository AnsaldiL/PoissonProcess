---
title: "Projet ALEA üêÜ"
author: "Lucile Ansaldi"
date: "2023-12-28"
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

## Partie 1 : Un seul jaguar dans la zone de suivi

### Question 1 :

Les hypoth√®ses suivantes peuvent √™tre formul√©es :

-   La cam√©ra est indetectable par le jaguar ou n'a ni effet attirant ni
    effet r√©pulsant sur celui-ci. Autrement dit, un passage devant la
    cam√©ra n'a pas d'effet sur le prochain.
-   Le territoire du jaguar est ferm√© ou on suppose que le jaguar ne va
    pas le quitter. (- On suppose que le jaguar effectue une marche
    al√©atoire, sa position au temps t d√©pend uniquement de sa position
    au temps t-1 et non de son parcourt pass√©. )

On se place dans un cadre o√π le temps est consid√©r√© comme continu l√† o√π
l'espace est discr√©tis√©.

### Question 2 :

En mod√©lisant le processus √† l'aide d'un processus ponctuel d'intensit√©
$\mu$ , on choisi ici un processus de Poisson homog√®ne, on connait
imm√©diatement le nombre d'observation moyen par unit√© de temp, c'est le
param√®tre de la loi de Poisson, nomm√© ici $\mu$.

Ainsi, pour avoir le nombre de capture moyen effectu√© en une journ√©e, on
multiplie l'intensit√© des catures par heure par le nombre d'heures dans
une journ√©e. On obtient : $24.\mu$.

### Question 3 :

Comme le processus est al√©atoir, on le mod√©lise √† l'aide selon un
processus de Poisson homog√®ne. La loi du nombre de captures effectu√©es
chaque jour (not√© $N$) est la suivante : $N \sim P(\mu*T_{max})$, avec
ici $T_{max}=24$. Ainsi, une loi de Poisson est utilis√©e pour mod√©liser
le nombre de cature effectu√© en une journ√©e.

### Question 4 :

En supposant que le jaguar est une activit√© diff√©rente la nuit et le
jour (avec une p√©riode d'activit√© une de repos au fil de la journ√©e), il
s'agit de modifier le param√®tre de la loi de Poisson, $\mu$, afin
d'autoriser plus de capture durant la p√©riode d'activit√© du jaguar.
Ainsi, un $\mu_{jour}$ et un $\mu_{nuit}$ diff√©rents permettent
d'expliciter cette diff√©rence d'activit√©.

Suite √† cette modification, on acc√®de au nombre de capture effectu√© en
une journ√©e, $N$, comme suit : $N = N_{jour} + N_{nuit}$ avec :

$$
N_{jour} \sim P(\mu_{jour}.T_{jour})\\
N_{nuit} \sim P(\mu_{nuit}.T_{nuit})
$$

O√π $T_{jour}$ et $T_{nuit}$ sont respectivement les dur√©es du jour et de
la nuit.

### Question 5 :

En prenant en compte la territorialit√© du jaguar, on va venir
sanctionner le nombre de captures effectu√© par la cam√©ra selon sa
distance au centre d'activit√© du jaguar. Ainsi, on multiplie le taux de
capture moyen effectu√© par unit√© de temps, $\mu$, par le coefficient
d'att√©nuation $exp(-\frac{d^2}{2})$. On adonc le mod√®le suivant : $$
N = N_{jour} + N_{nuit}\\
N_{jour} \sim P(\mu_{jour}.exp\left(-\frac{d^2}{2}\right).T_{jour})\\
N_{nuit} \sim P(\mu_{nuit}.exp\left(-\frac{d^2}{2}\right).T_{nuit})
$$

## Partie 2 : Deux jaguars dans la zone de suivi :

### Question 6 :

Avec deux jaguars dans la zone d'√©tude, il s'agit toujours d'un
processus de Poisson mais deux evennements peuvent mener √† la
r√©alisation d'une capture : "Le premier jaguar passe devant la cam√©ra"
ou "Le deuxi√®me jaguar passe devant la cam√©ra". On exclu le cas ou "les
deux jaguars passent simultan√©ment devant la cam√©ra et la d√©clanchent".

Sur le sch√©ma repr√©sentant le processus, on a obtenu les √©vennements
suivants :

-   En t1, le jaguar 1 est pass√© devant la cam√©ra et a ainsi d√©clancher
    la premi√®re capture. Il est repass√© en t2.

-   En t3, c'est le deuxi√®me jaguar qui est pass√©.

### Question 7 :

On suppose que les jaguars ne sont pas identifiables individuellement.
Avec deux jaguars au lieu d'un, on attend deux fois plus de capture par
jour. En effet, supposons tout d'abord que les deux jaguars soient
discernables : en notant $U_1$ le temps auquel est observ√© le premier
jaguar et $U_2$ le temps auquel est observ√© le second, on a :

$$
U_1 \sim E(\mu)\\
U_2 \sim E(\mu)\\
min(U_1, U_2) \sim E(2.\mu)
$$

C'est √† dire que le temps s√©parant deux √©vennement "la cam√©ra est
d√©clanch√©e" suit une loi exponnetielle de param√®tre $2.\mu$. On a en
fait deux fois plus de chance de voir l'√©v√®nnement se r√©aliser par
rapport au cas o√π un seul jaguar est consid√©r√©. Cela m√®ne donc √† deux
fois plus d'observations de jaguar √† la fin de la journ√©e. Ainsi, en
moyenne, on a $2*24*\mu.$ photos de jaguars.

### Question 8 :

L'intensit√© du processus ponctuel donnant les instants de d√©tection, une
loi exponnentielle comme pr√©sent√©e pr√©c√©demment, est de $2.mu$.

### Question 9 :

On mod√©lise le processus comme suit :

D'une part, on note $N$ le nombre de capture. On a donc :

$$
N = N_1 + N_2\\
N_1 = N_{1jour} + N_{1nuit}\\
N_1jour \sim P(\mu_{jour}.exp\left(-\frac{d_1^2}{2}\right).T_{jour})\\
N_1nuit \sim P(\mu_{nuit}.exp\left(-\frac{d_1^2}{2}\right).T_{nuit})\\
$$

On a la m√™me relation avec $N_2$, au changement de distance
cam√©ra-centre d'activit√© du jaguar pr√®s.

D'autre part, on note $T$ le temps s√©parant deux captures. On a une
dur√©e entre deux cature diff√©rente selon le jour et la nuit, ainsi, on
consid√®re $T_{jour}$ et $T_{nuit}$. Pour les captures effectu√©es de
jour, on a :

$$
T_{jour} = min(T_{1jour}, T_{2jour})\\
T_{1jour} \sim E(- \mu_{jour}.exp\left(\frac{-d_1^2}{2}\right).t)\\
T_{2jour} \sim E(- \mu_{jour}.exp\left(\frac{-d_2^2}{2}\right).t)\\
$$

De la m√™me mani√®re, on a un temps entre deux capture de nuit, not√©
$T_nuit$. $$
T_{nuit} = min(T_{1nuit}, T_{2nuit})\\
T_{1nuit} \sim E(- \mu_{nuit}.exp\left(\frac{-d_1^2}{2}\right).t)\\
T_{2nuit} \sim E(- \mu_{nuit}.exp\left(\frac{-d_2^2}{2}\right).t)
$$

## Partie 3 : Mise en oeuvre

### Question 10 :

```{r}
## param√®tres :
#dur√©e de la nuit Tn et du jour Tj :
dn <- 18 #√† quelle heure tombe la nuit ?
fn <- 8 #√† quelle heure se l√®ve le jour ?
Tn <- 24 - dn + fn
Tj <- 24 - Tn

d1 <- 0.5
d2 <- 1
muj <- 1
mun <- 3

attenuation <- function(d){ #fonction d'att√©nuation
  exp(-(d**2)/2)
}

## Mod√©lisation :
#nombre de capture le jour
Nj1 <- c(rpois(1, muj*attenuation(d1)*Tj))
Nj2 <- c(rpois(1, muj*attenuation(d2)*Tj))
Nj <- Nj1 + Nj2
#temps auxquels adviennent ces captures
Tmpsj <- c(runif(Nj, 0, Tj))

#nombre de capture la nuit
Nn1 <- c(rpois(1, mun*attenuation(d1)*Tn))
Nn2 <- c(rpois(1, mun*attenuation(d2)*Tn))
Nn <- Nn1 + Nn2
#temps auxquels adviennent ces captures
Tmpsn <- c(runif(Nn, 0, Tn))

matin <- round(((fn)/Tn)*Nn) #proportion de la nuit qui appartient au matin

Tmpsj <- sort(Tmpsj)
Tmpsn <- sort(Tmpsn)

#d√©callage pour avoir la journ√©e de 0h √† 24h, en ayant s√©par√© la nuit en 2.
Tmps <- c(Tmpsn[0:matin], Tmpsj + fn, Tmpsn[(matin+1):length(Tmpsn)] + (dn-fn))


plot(x = Tmps, y = rep(0,  length(Tmps)), xlab ="jour", ylab="", main="Instants auxquels sont advenues les captures au cours de la journ√©e")
#mettre les l√©gendes, les barres verticales pour le jour et la nuit ?
```

## Question 11

Il s'agit de r√©p√©ter l'exp√©rience et de calculer une moyenne du nombre
de captures par jour.

```{r}
#param√®tres :
#heure de la nuit et du jour :
dn <- 18
fn <- 8
Tn <- 24 - dn + fn
Tj <- 24 - Tn
rep <- 1000  #nombre de r√©p√©tition pour le calcul de la moyenne

d1 <- 0.5
d2 <- 1
muj <- 1
mun <- 3

attenuation <- function(d){
  exp(-(d**2)/2)
}

#boucle de calcul de la moyenne :
S = c()
for (k in 1:rep){
  #nombre de capture le jour
  Nj1 <- c(rpois(1, muj*attenuation(d1)*Tj))
  Nj2 <- c(rpois(1, muj*attenuation(d2)*Tj))
  Nj <- Nj1 + Nj2

  #nombre de capture la nuit
  Nn1 <- c(rpois(1, mun*attenuation(d1)*Tn))
  Nn2 <- c(rpois(1, mun*attenuation(d2)*Tn))
  Nn <- Nn1 + Nn2

  #nombre total de captures
  N <- Nj + Nn
  S <- c(S, N)
}

paste("Le nombre de capture effectu√© par jour est :", round((sum(S)/length(S)), digits = 2))
```

## Question 12 :

On peut obtenir ce r√©sulat par le calcul car le param√®tre de la loi de
Poisson est le nombre moyen de capture par unit√© de temps. Ainsi, on
retrouve le nombre de captures attendu en moyenne dans la journ√©e en le
multipliant par le temps d'interet. Ici, avec les activit√© noctures et
diurne et les distances √† la cam√©ra, on formule le calcul suivant :

```{r}
paste("Le nombre moyen de capture effectu√©es par jour est :",round(muj*attenuation(d1)*Tj + muj*attenuation(d2)*Tj + mun*attenuation(d1)*Tn + mun*attenuation(d2)*Tn, digits=2))

paste("L'erreur commise par l'estimateur est de l'ordre de :", round(1/sqrt(rep), digits = 3))
```

On constate que le r√©sulat obtenu par calcul est tr√®s proche de celui
obtenu avec les simulations de Monte-Carlo. Cela confirme que la
**moyenne** calcul√©e est un bon estimateur de l'**esp√©rance**, on a ici
une erreur de l'ordre du centi√®me.
